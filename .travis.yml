addons:
  apt:
    update: true
    packages:
      - build-essential
      - libssl-dev
      - git


services: docker
language: crystal
before_install: 
  - pip install yamllint --user
  - git clone https://github.com/wg/wrk.git /tmp/wrk && cd /tmp/wrk && make && cp wrk ~/bin/ && cd -

install: shards build --release

env:
  matrix:
    - "TESTLANG=crystal"
    - "TESTLANG=ruby"
    - "TESTLANG=nim"
    - "TESTLANG=python"
    - "TESTLANG=go"
    - "TESTLANG=swift"
    - "TESTLANG=rust"
    - "TESTLANG=node"
    - "TESTLANG=elixir"
    - "TESTLANG=cpp"
    - "TESTLANG=scala"
    - "TESTLANG=csharp"
    - "TESTLANG=java"

script:
  - crystal spec
  - bin/ameba tools
  - bin/ameba crystal/*
  - yamllint shard.yml
  - yamllint neph.yaml
  - yamllint .travis.yml
  - make ${TESTLANG}
  - bin/benchmarker ${TESTLANG} -r 1
